---
interface FilterOption {
  value: string;
  label: string;
  count: number;
}

interface Props {
  id: string;
  label: string;
  options: FilterOption[];
  allLabel?: string;
}

const { id, label, options, allLabel = "All" } = Astro.props;
---

<details class="filter-dropdown relative" data-filter-group={id}>
  <summary
    class="list-none flex items-center justify-between gap-2 border border-ink bg-white text-ink text-xs uppercase tracking-widest px-4 py-3 cursor-pointer select-none focus:ring-2 focus:ring-ink focus:outline-none w-full"
    aria-label={`Filter by ${label}`}
  >
    <span class="filter-summary-text truncate">{allLabel}</span>
    <svg
      class="shrink-0 w-4 h-4 text-ink transition-transform filter-chevron"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      viewBox="0 0 24 24"
      aria-hidden="true"
    >
      <path stroke-linecap="square" d="M6 9l6 6 6-6"></path>
    </svg>
  </summary>
  <div
    class="absolute z-20 left-0 top-full mt-px w-full min-w-[12rem] border border-ink border-t-0 bg-white max-h-64 overflow-y-auto"
  >
    {
      options.map((opt) => (
        <label class="flex items-center gap-3 px-4 py-2.5 cursor-pointer hover:bg-cream transition-colors text-xs uppercase tracking-widest">
          <input
            type="checkbox"
            name={id}
            value={opt.value}
            class="accent-ink w-3.5 h-3.5 cursor-pointer shrink-0"
          />
          <span class="truncate">{opt.label}</span>
          <span class="ml-auto text-stone-500 tabular-nums">{opt.count}</span>
        </label>
      ))
    }
  </div>
</details>

<style>
  details[open] .filter-chevron {
    transform: rotate(180deg);
  }
  details summary::-webkit-details-marker {
    display: none;
  }
</style>
